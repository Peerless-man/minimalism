---
title: 虚拟DOM和模版编译
date: 2023-12-25
category: Vue2
---

# 虚拟 DOM

DOM(Document Object Model) 文档对象模型

虚拟 DOM 是对真实 DOM 的一种抽象 是一个 js 对象

vue 在生成真实 DOM 之前 会将模板 template 编译为一个虚拟 DOM 对象(virtual dom) 当页面元素变化时 vue 只需要判断虚拟 DOM 的变化 然后根据变化对应到真实 DOM 上修改

优点：

1. 减少 dom 操作
2. 因为是虚拟的 dom 所以不同平台可以编写对应的渲染函数进行渲染

缺点：

1. 比直接生成 dom 操作多了一层生成虚拟 dom 的时间 所以当 dom 过大时 生成虚拟 dom 会耗费更长的时间

# 模板编译

模板编译过程

1. 获取 template 内的 dom
2. 解析模板 生成 AST 语法树
3. 将 AST 语法树转成一个 render 函数 render 函数里包括`_c`、`_v`、`_s` 等函数
4. 调用 render 函数 生成虚拟 DOM 5.执行 patch 方法 通过 diff 算法比较新老 DOM 的不同 对真实 DOM 进行重新渲染或者是打补丁 修改有变化的部分

流程图
![](/posts/vue2/templateRender.png)
